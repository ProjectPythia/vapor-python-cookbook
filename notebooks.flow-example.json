{"version":2,"kind":"Notebook","sha256":"f831c8457ad77979acacdef45faa7ce702c38be0fafa53ea745c6556ab934fd3","slug":"notebooks.flow-example","location":"/notebooks/flow_example.ipynb","dependencies":[],"frontmatter":{"title":"Advecting Flow Paths","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"vapor","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/vapor-python-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/vapor-python-cookbook/blob/main/notebooks/flow_example.ipynb","exports":[{"format":"ipynb","filename":"flow_example.ipynb","url":"/vapor-python-cookbook/build/flow_example-b3926aed486f6e3a68ea21a070736e3a.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Vapor can advect and render flow paths through your data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BkDVFqTMG2"}],"key":"mH7hg0gION"}],"key":"cktcLFsLn1"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:39.854271Z","iopub.status.busy":"2023-06-22T17:21:39.853971Z","iopub.status.idle":"2023-06-22T17:21:46.140430Z","shell.execute_reply":"2023-06-22T17:21:46.139618Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import example_utils\nfrom vapor import session, renderer, dataset, camera\n\nses = session.Session()\ndata = example_utils.OpenExampleDataset(ses)","key":"oI9Ho449VU"},{"type":"output","id":"ZUVsKkw-2xLN6NFEY-FJO","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[1]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mexample_utils\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m session, renderer, dataset, camera\n\u001b[32m      4\u001b[39m ses = session.Session()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/work/vapor-python-cookbook/vapor-python-cookbook/notebooks/example_utils.py:20\u001b[39m\n\u001b[32m     16\u001b[39m     sys.path.append(\u001b[33m'\u001b[39m\u001b[33m..\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01minspect\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m signature\n\u001b[32m---> \u001b[39m\u001b[32m20\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnumpy\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnp\u001b[39;00m\n\u001b[32m     21\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mmath\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m sin\n\u001b[32m     23\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mSampleFunctionOnRegularGrid\u001b[39m(f, ext=\u001b[38;5;28;01mNone\u001b[39;00m, shape=\u001b[38;5;28;01mNone\u001b[39;00m):\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'numpy'","ename":"ModuleNotFoundError","evalue":"No module named 'numpy'"}],"key":"qHdNZaeh87"}],"key":"NBFp8O3726"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Default advection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"gzpj08HhPS"}],"identifier":"default-advection","label":"Default advection","html_id":"default-advection","implicit":true,"key":"hJis9eq9wR"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"When you create a Flow renderer, the default advection will create a regularly dispersed grid of seed points and simulate a streamline advection in 2D or 3D, depending on the provided variables.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"jV86DQ3epe"}],"key":"CFI1UmsQJs"}],"key":"yhotzpBjv2"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.144664Z","iopub.status.busy":"2023-06-22T17:21:46.144287Z","iopub.status.idle":"2023-06-22T17:21:46.476511Z","shell.execute_reply":"2023-06-22T17:21:46.475881Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Use first 2 2D variables as our U,V for the flow advection\ndimension = 2\nU,V = data.GetDataVarNames(dimension)[0:2]\n\nren:renderer.FlowRenderer = data.NewRenderer(renderer.FlowRenderer)\nren.SetFieldVariableNames([U, V])\nses.GetCamera().ViewAll()\nses.Show()","key":"fp1yVjAVr3"},{"type":"output","id":"M5CQPa9Y1_iq-nWscBZSt","data":[],"key":"erTHLdkN3T"}],"key":"i34fWVv0Gp"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Rendering techniques","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AI9sIttzgw"}],"identifier":"rendering-techniques","label":"Rendering techniques","html_id":"rendering-techniques","implicit":true,"key":"i2uDzopmUc"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The rendering of the flow paths can be configured. A few examples are shown below.\nCall help(renderer.FlowRenderer) to see additional options.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"p95N43n6xM"}],"key":"OJaxNjPYEH"}],"key":"joBtsygxSx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.479431Z","iopub.status.busy":"2023-06-22T17:21:46.479193Z","iopub.status.idle":"2023-06-22T17:21:46.630855Z","shell.execute_reply":"2023-06-22T17:21:46.630223Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetRenderType(ren.RenderType.RenderTypeStream)\nren.SetRenderRadiusScalar(3)\nren.SetRenderGeom3D(True)\nren.SetColorMapVariableName(U)\nses.Show()","key":"wnsu0Zfik5"},{"type":"output","id":"Uo5r-QglKxIdsdVqfPVZZ","data":[],"key":"Kt9Kx44lw2"}],"key":"u9OAlrJKRr"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Rather than rendering the flow lines, you can also render the sample points that are taken along the flow path individually.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sq1l5xQHai"}],"key":"pwEtwxvDVs"}],"key":"TGbB8hplh6"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.633492Z","iopub.status.busy":"2023-06-22T17:21:46.633267Z","iopub.status.idle":"2023-06-22T17:21:46.691538Z","shell.execute_reply":"2023-06-22T17:21:46.690949Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetRenderType(ren.RenderType.RenderTypeSamples)\nses.Show()","key":"yplNhHrMYJ"},{"type":"output","id":"fmNOg2FSczFnnFCgKWl9C","data":[],"key":"O3wn2sXnUx"}],"key":"SXT1SwE0JB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.694219Z","iopub.status.busy":"2023-06-22T17:21:46.694028Z","iopub.status.idle":"2023-06-22T17:21:46.820968Z","shell.execute_reply":"2023-06-22T17:21:46.820377Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetRenderGlyphType(ren.GlpyhType.GlpyhTypeArrow)\nren.SetRenderRadiusScalar(7)\nses.Show()","key":"Pfy42Y5EXK"},{"type":"output","id":"dg6eEIDNhiN0kOh4j0bvY","data":[],"key":"EzVng9pi7x"}],"key":"C0wDgWeo8Y"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.823965Z","iopub.status.busy":"2023-06-22T17:21:46.823519Z","iopub.status.idle":"2023-06-22T17:21:46.826861Z","shell.execute_reply":"2023-06-22T17:21:46.826229Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Reset the rendering style for the next section\nren.SetRenderRadiusScalar(3)\nren.SetRenderType(ren.RenderType.RenderTypeStream)","key":"wMoTfBusNy"},{"type":"output","id":"P7mwok3CKwGcCnm_amm27","data":[],"key":"oPEeiCRJIf"}],"key":"yOfiwuZaOE"},{"type":"block","kind":"notebook-content","data":{"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Seeding the advection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rbIKvdnAQu"}],"identifier":"seeding-the-advection","label":"Seeding the advection","html_id":"seeding-the-advection","implicit":true,"key":"ZYJfA1XD4c"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The seeds from which the advected particles start can be configured in a variety of manners.\nCall help(renderer.FlowRenderer) to see additional options.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"npveULIlvj"}],"key":"Ul9N9KhWkc"}],"key":"LqAvHt2NrK"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Uniform Distribution","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IYvRxxPJmQ"}],"identifier":"uniform-distribution","label":"Uniform Distribution","html_id":"uniform-distribution","implicit":true,"key":"IA1bL7aEP3"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This is the default. It creates a uniformly distributed grid of seed points over the area/volume of the advected region.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dD0Bwbcy5c"}],"key":"WT0NUk6Nm7"}],"key":"Tj0ZGrxt3x"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.829533Z","iopub.status.busy":"2023-06-22T17:21:46.829301Z","iopub.status.idle":"2023-06-22T17:21:47.056742Z","shell.execute_reply":"2023-06-22T17:21:47.056106Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetSeedGenMode(ren.FlowSeedMode.UNIFORM)\nrake = ren.GetRakeRegion()\ndefaultRakeExtents = rake.GetExtents()\nrake.SetExtents((20, 20), (40, 40))\nprint(f\"Seeding a {ren.GetGridNumOfSeeds()} grid over {rake.GetExtents()}\")\nses.Show()\nrake.SetExtents(*defaultRakeExtents)","key":"eMda8MGnWf"},{"type":"output","id":"9ZygUbifXQmDOFkgJjzIu","data":[],"key":"Qq34Qzgzhq"}],"key":"I59CNWgs00"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Random Distribution","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MyPrHbe6CT"}],"identifier":"random-distribution","label":"Random Distribution","html_id":"random-distribution","implicit":true,"key":"C5tsRA0SWa"}],"key":"ju332k15zP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:47.059731Z","iopub.status.busy":"2023-06-22T17:21:47.059483Z","iopub.status.idle":"2023-06-22T17:21:47.119473Z","shell.execute_reply":"2023-06-22T17:21:47.118849Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetSeedGenMode(ren.FlowSeedMode.RANDOM)\nprint(f\"Seeding {ren.GetRandomNumOfSeeds()} random points over {rake.GetExtents()}\")\nses.Show()","key":"j81eUtzubM"},{"type":"output","id":"rE2hl2cnrPVSJdspYJpPV","data":[],"key":"BhhO9IAmcD"}],"key":"ZoEVUsfolp"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Biased Distribution","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"X81Ihkcl45"}],"identifier":"biased-distribution","label":"Biased Distribution","html_id":"biased-distribution","implicit":true,"key":"SVcjfu8Y5a"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This generates a random list of seed points however they are biased by a given variable.\nThe number of seed points can be higher or lower based on the value of the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"cjr1O6gedv"},{"type":"inlineCode","value":"RakeBiasVariable","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nCd4YziLWj"},{"type":"text","value":".\nYou can set the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"BXII1yuuD6"},{"type":"inlineCode","value":"RakeBiasStrength","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"s9OBY1ckPt"},{"type":"text","value":" to a negative value to invert the bias.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"rBa0RJYFrp"}],"key":"opLXyuQcPl"}],"key":"DUqtE6zeG3"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:47.122371Z","iopub.status.busy":"2023-06-22T17:21:47.122118Z","iopub.status.idle":"2023-06-22T17:21:47.191623Z","shell.execute_reply":"2023-06-22T17:21:47.191104Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetSeedGenMode(ren.FlowSeedMode.RANDOM_BIAS)\nren.SetRakeBiasVariable(V)\nren.SetRakeBiasStrength(1)\nprint(f\"Seeding {ren.GetRandomNumOfSeeds()} random points biased by {ren.GetRakeBiasVariable()} over {rake.GetExtents()}\")\nses.Show()","key":"il8VIhNHsx"},{"type":"output","id":"i0ZPG1Ag0QdJkuYs9b589","data":[],"key":"O7jM7izdQH"}],"key":"HWiA1tpiK4"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Manual List","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mnCzqSHThZ"}],"identifier":"manual-list","label":"Manual List","html_id":"manual-list","implicit":true,"key":"Alb0vMNwWB"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"You can pass in a manually created list of seeds using a basic text file format.\nThe code below generates an example seed file and passes it to Vapor.\nThe full documentation for the seed file format can be found on Vapor’s website.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"VqKy5P9u2s"}],"key":"NYi0L6y034"}],"key":"I8KDk1J5lV"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:47.194692Z","iopub.status.busy":"2023-06-22T17:21:47.194336Z","iopub.status.idle":"2023-06-22T17:21:47.240073Z","shell.execute_reply":"2023-06-22T17:21:47.239479Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"with open(\"flow_seeds.txt\", \"w\") as f:\n    print(\"# X, Y, Z, T (optional)\", file=f)\n    print(\"10, 10, 0\", file=f)\n    print(\"20, 20, 0\", file=f)\n\nren.SetSeedGenMode(ren.FlowSeedMode.LIST)\nren.SetSeedInputFilename(\"flow_seeds.txt\")\nses.Show()","key":"xAxeRlpolz"},{"type":"output","id":"d8uSZPzKVCpJ5RtVNOFE8","data":[],"key":"VXc83enoKA"}],"key":"bprCAEMcf6"}],"key":"Zqg8nd9TVr"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Keyframing with Vapor","url":"/notebooks/keyframing-example","group":"Foundations of VAPOR Python"},"next":{"title":"Visualizer Widgets","url":"/notebooks/visualizer-widget-example","group":"Foundations of VAPOR Python"}}},"domain":"http://localhost:3000"}