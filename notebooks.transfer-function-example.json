{"version":2,"kind":"Notebook","sha256":"b8562427ef579ad14247811d47453b54affbc4660b6a923c6404521401a63be3","slug":"notebooks.transfer-function-example","location":"/notebooks/transfer_function_example.ipynb","dependencies":[],"frontmatter":{"title":"Transfer Functions","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"vapor","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/vapor-python-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/vapor-python-cookbook/blob/main/notebooks/transfer_function_example.ipynb","exports":[{"format":"ipynb","filename":"transfer_function_example.ipynb","url":"/vapor-python-cookbook/build/transfer_function_ex-a2cbf81cf82e6c7e2e840eef81e5e8da.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can change a visualization’s appearance by accessing and modifying its transfer function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hIEM4nWzIJ"}],"key":"TffkbWcafl"}],"key":"gQ8hLXO595"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:58.778786Z","iopub.status.busy":"2023-06-22T17:21:58.778453Z","iopub.status.idle":"2023-06-22T17:22:05.241471Z","shell.execute_reply":"2023-06-22T17:22:05.240918Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import example_utils\nfrom vapor import session, renderer, dataset, camera, transferfunction\nfrom vapor.utils import histogram\n\nses = session.Session()\ndata = example_utils.OpenExampleDataset(ses)\n\nren = data.NewRenderer(renderer.VolumeRenderer)\nses.GetCamera().LookAt((32, 120, 120), (32, 32, 32))\nses.Show()","key":"SmLwsMSfHM"},{"type":"output","id":"_VwcnHtmNKfWpdJW1JQyE","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[1]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mexample_utils\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m session, renderer, dataset, camera, transferfunction\n\u001b[32m      3\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mutils\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m histogram\n\n\u001b[36mFile \u001b[39m\u001b[32m~/work/vapor-python-cookbook/vapor-python-cookbook/notebooks/example_utils.py:20\u001b[39m\n\u001b[32m     16\u001b[39m     sys.path.append(\u001b[33m'\u001b[39m\u001b[33m..\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01minspect\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m signature\n\u001b[32m---> \u001b[39m\u001b[32m20\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnumpy\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnp\u001b[39;00m\n\u001b[32m     21\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mmath\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m sin\n\u001b[32m     23\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mSampleFunctionOnRegularGrid\u001b[39m(f, ext=\u001b[38;5;28;01mNone\u001b[39;00m, shape=\u001b[38;5;28;01mNone\u001b[39;00m):\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'numpy'","ename":"ModuleNotFoundError","evalue":"No module named 'numpy'"}],"key":"aGDvfDICxG"}],"key":"TwArnvBVPx"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Changing Opacities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TyMr9SFTEX"}],"identifier":"changing-opacities","label":"Changing Opacities","html_id":"changing-opacities","implicit":true,"key":"cKO102z0Sy"}],"key":"MDee5Gw9bY"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vapor’s transferFunctionWidget allows you to adjust the opacity points of a renderer as you would within Vapor’s GUI.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"m6ENngG8Vm"}],"key":"YYrxEihxpA"}],"key":"tQ4hOHwQeU"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from vapor.utils import histogram\nhistogram.transferFunctionWidget(ses, ren)","key":"wn79FzYTGr"},{"type":"output","id":"GoGtV4de9PegwBVFYU-kU","data":[],"key":"QWffLrkV9Q"}],"key":"gCBvzfq96t"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"If you do not have access to the widget, we provide static options for changing the opacities as well.\nWe created a volume rendering however it is fully opaque.\nWe can use a transfer function to adjust the visible portions.\nBefore we adjust the opacity map of the TF, we get a histogram to help us determine what we want to hide.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YCNOeB12yZ"}],"key":"LXBdPLin89"}],"key":"J3bvf2ULOJ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:05.244530Z","iopub.status.busy":"2023-06-22T17:22:05.244180Z","iopub.status.idle":"2023-06-22T17:22:05.692101Z","shell.execute_reply":"2023-06-22T17:22:05.691266Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"histogram.ShowMatPlotLibHistogram(ses, ren)","key":"vu5FRdtioo"},{"type":"output","id":"CS6kLJU-46PayFgbho2gV","data":[],"key":"SvdNaDXWwn"}],"key":"QWtBrXVvUb"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Usually we want to hide the most common value so below we construct an opacity map that accomplishes this.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"mcaz1l8y9Y"}],"key":"nHntGznj4S"}],"key":"qAIXEKyAWw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:05.696040Z","iopub.status.busy":"2023-06-22T17:22:05.695730Z","iopub.status.idle":"2023-06-22T17:22:05.699716Z","shell.execute_reply":"2023-06-22T17:22:05.699008Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# List of x,y pairs where x is the data value and y is the opacity for that data value\nopacities = [(-0.3, 1), (-0.1, 0), (0.1, 0), (0.3, 1)]","key":"ogZvfFfbcE"},{"type":"output","id":"pN_vnolKORKfgZUMxDXDw","data":[],"key":"lJmoxnSfA7"}],"key":"sryMYqPTjr"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We can get the matplotlib histogram plot and add our opacity map to it to compare.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"v6fDemDPSM"}],"key":"e5IdBgN8bn"}],"key":"PY6dVYdYvo"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:05.703401Z","iopub.status.busy":"2023-06-22T17:22:05.703122Z","iopub.status.idle":"2023-06-22T17:22:06.033748Z","shell.execute_reply":"2023-06-22T17:22:06.032984Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plt = histogram.GetMatPlotLibHistogram(ses, ren)\nplt.plot(*zip(*opacities))\nplt.show()","key":"ofcGOtDxp9"},{"type":"output","id":"JIYNr-eMdAkEOHneHDQSk","data":[],"key":"h3m3GNmmXN"}],"key":"Qt2BEHDxiQ"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we apply the map to the transfer function","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pxC4AA1F0h"}],"key":"EImDym0OJs"}],"key":"NlIXwJiZ7J"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:06.037679Z","iopub.status.busy":"2023-06-22T17:22:06.037302Z","iopub.status.idle":"2023-06-22T17:22:06.147564Z","shell.execute_reply":"2023-06-22T17:22:06.146876Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Renderers can have multiple transfer functions.\n# GetPrimaryTransferFunction returns the one that is usually the most useful.\n# You can use `tf.GetTransferFunction(var_name)` to get other transfer functions.\ntf = ren.GetPrimaryTransferFunction()\ntf.SetOpacityControlPoints(opacities)\nses.Show()","key":"XzG1Apm7GO"},{"type":"output","id":"krqtP1c1KrX_8I2nor0yd","data":[],"key":"Uo9GoXff72"}],"key":"GMcE9pzgli"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You can adjust the colormap in a similar fashion. Use ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sJQBuyexJQ"},{"type":"inlineCode","value":"help(tf)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"rt6ok7LrgJ"},{"type":"text","value":" for more information.\nVapor includes a list of built-in colormaps and these can be applied with ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GJNB8v07c7"},{"type":"inlineCode","value":"tf.LoadBuiltinColormap(name)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uSemhpOHo1"}],"key":"SLVNoKT0oo"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Builtin Colormaps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"YTZ4VjMgF5"}],"identifier":"builtin-colormaps","label":"Builtin Colormaps","html_id":"builtin-colormaps","implicit":true,"key":"kLJGGoZyj3"}],"key":"YLx0dLlaZn"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:06.150546Z","iopub.status.busy":"2023-06-22T17:22:06.150311Z","iopub.status.idle":"2023-06-22T17:22:06.227098Z","shell.execute_reply":"2023-06-22T17:22:06.226389Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"tf.LoadBuiltinColormap(\"Sequential/BlackBodyExtended\")\nses.Show()","key":"xuPqkTL07F"},{"type":"output","id":"FDd8WqukyGsdsgcb-tSWe","data":[],"key":"qVxJPcucAz"}],"key":"DxPMqrr4Z0"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"List of All Builtin Colormaps","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"yeNjUN4euj"}],"identifier":"list-of-all-builtin-colormaps","label":"List of All Builtin Colormaps","html_id":"list-of-all-builtin-colormaps","implicit":true,"key":"b415DXziZk"}],"key":"jBzutc0dcj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:06.230070Z","iopub.status.busy":"2023-06-22T17:22:06.229816Z","iopub.status.idle":"2023-06-22T17:22:10.518508Z","shell.execute_reply":"2023-06-22T17:22:10.517729Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"\nses.DeleteRenderer(ren)\nren = data.NewRenderer(renderer.TwoDDataRenderer)\ntf = ren.GetPrimaryTransferFunction()\n\nfor cmap in transferfunction.TransferFunction.ListBuiltinColormaps():\n    tf.LoadBuiltinColormap(cmap)\n\n    print(cmap)\n    tf.ShowMatPlotLibColorbar()","key":"pivCRzAxxH"},{"type":"output","id":"OrBG1FcsTGTbvGOae6lF_","data":[],"key":"iL6rOU46WZ"}],"key":"I2zkGqZFby"}],"key":"kGA8vTbqZN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Controlling the Camera","url":"/notebooks/camera-example","group":"Foundations of VAPOR Python"},"next":{"title":"Annotations","url":"/notebooks/annotation-example","group":"Foundations of VAPOR Python"}}},"domain":"http://localhost:3000"}