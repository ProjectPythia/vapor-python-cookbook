{"version":2,"kind":"Notebook","sha256":"b8562427ef579ad14247811d47453b54affbc4660b6a923c6404521401a63be3","slug":"notebooks.transfer-function-example","location":"/notebooks/transfer_function_example.ipynb","dependencies":[],"frontmatter":{"title":"Transfer Functions","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"vapor","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/vapor-python-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/vapor-python-cookbook/blob/main/notebooks/transfer_function_example.ipynb","exports":[{"format":"ipynb","filename":"transfer_function_example.ipynb","url":"/vapor-python-cookbook/build/transfer_function_ex-9a32bcc475a7e94399b857dc673b37b8.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"You can change a visualization’s appearance by accessing and modifying its transfer function.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p4cp1ZlqqT"}],"key":"FYSSNmOBnb"}],"key":"uQyGAKh06z"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:58.778786Z","iopub.status.busy":"2023-06-22T17:21:58.778453Z","iopub.status.idle":"2023-06-22T17:22:05.241471Z","shell.execute_reply":"2023-06-22T17:22:05.240918Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import example_utils\nfrom vapor import session, renderer, dataset, camera, transferfunction\nfrom vapor.utils import histogram\n\nses = session.Session()\ndata = example_utils.OpenExampleDataset(ses)\n\nren = data.NewRenderer(renderer.VolumeRenderer)\nses.GetCamera().LookAt((32, 120, 120), (32, 32, 32))\nses.Show()","key":"E0sQLFaGkI"},{"type":"output","id":"8tauZVzqmr9odEzM7LaHo","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[1]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mexample_utils\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m session, renderer, dataset, camera, transferfunction\n\u001b[32m      3\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[34;01m.\u001b[39;00m\u001b[34;01mutils\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m histogram\n\n\u001b[36mFile \u001b[39m\u001b[32m~/work/vapor-python-cookbook/vapor-python-cookbook/notebooks/example_utils.py:20\u001b[39m\n\u001b[32m     16\u001b[39m     sys.path.append(\u001b[33m'\u001b[39m\u001b[33m..\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01minspect\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m signature\n\u001b[32m---> \u001b[39m\u001b[32m20\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnumpy\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnp\u001b[39;00m\n\u001b[32m     21\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mmath\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m sin\n\u001b[32m     23\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mSampleFunctionOnRegularGrid\u001b[39m(f, ext=\u001b[38;5;28;01mNone\u001b[39;00m, shape=\u001b[38;5;28;01mNone\u001b[39;00m):\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'numpy'","ename":"ModuleNotFoundError","evalue":"No module named 'numpy'"}],"key":"k0Du8p82Zp"}],"key":"mPnrZbAvRV"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Changing Opacities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UW3ZHPP74i"}],"identifier":"changing-opacities","label":"Changing Opacities","html_id":"changing-opacities","implicit":true,"key":"HWqO3vA7xL"}],"key":"dgeBI3nsZt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Vapor’s transferFunctionWidget allows you to adjust the opacity points of a renderer as you would within Vapor’s GUI.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sSqZMmtC1j"}],"key":"GfP0KG0JV7"}],"key":"d2OsToTv9Z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"from vapor.utils import histogram\nhistogram.transferFunctionWidget(ses, ren)","key":"ECQ8Fxyuok"},{"type":"output","id":"I5ukfz0LpPWMTEQsXnkQ5","data":[],"key":"xcXXGx7D7j"}],"key":"CIGWi5L9I9"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"If you do not have access to the widget, we provide static options for changing the opacities as well.\nWe created a volume rendering however it is fully opaque.\nWe can use a transfer function to adjust the visible portions.\nBefore we adjust the opacity map of the TF, we get a histogram to help us determine what we want to hide.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BbuI2FRpSV"}],"key":"fSJRYMpvJl"}],"key":"AGDUGziat5"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:05.244530Z","iopub.status.busy":"2023-06-22T17:22:05.244180Z","iopub.status.idle":"2023-06-22T17:22:05.692101Z","shell.execute_reply":"2023-06-22T17:22:05.691266Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"histogram.ShowMatPlotLibHistogram(ses, ren)","key":"bovWijgZpi"},{"type":"output","id":"MfnsvZLiTK8GuwD4TlQ-u","data":[],"key":"HgZnjbyota"}],"key":"xcPQogbIXd"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Usually we want to hide the most common value so below we construct an opacity map that accomplishes this.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"HCt7ymtD6s"}],"key":"gbZPMI90XW"}],"key":"QXORhNAjDB"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:05.696040Z","iopub.status.busy":"2023-06-22T17:22:05.695730Z","iopub.status.idle":"2023-06-22T17:22:05.699716Z","shell.execute_reply":"2023-06-22T17:22:05.699008Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# List of x,y pairs where x is the data value and y is the opacity for that data value\nopacities = [(-0.3, 1), (-0.1, 0), (0.1, 0), (0.3, 1)]","key":"tqrlGaKX03"},{"type":"output","id":"gWRs8zHtHPR8L9z5TCjk5","data":[],"key":"T7aF5QeiSp"}],"key":"ajXZ3A9HxI"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"We can get the matplotlib histogram plot and add our opacity map to it to compare.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"RD4KPvzaGW"}],"key":"DiL84b5jyJ"}],"key":"m7WZXME3IH"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:05.703401Z","iopub.status.busy":"2023-06-22T17:22:05.703122Z","iopub.status.idle":"2023-06-22T17:22:06.033748Z","shell.execute_reply":"2023-06-22T17:22:06.032984Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"plt = histogram.GetMatPlotLibHistogram(ses, ren)\nplt.plot(*zip(*opacities))\nplt.show()","key":"IhHH6V8Aaq"},{"type":"output","id":"rzyqND4jGi5X2j0HI7AGy","data":[],"key":"X5VYZ4vevU"}],"key":"Le3TUf6IJs"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Now we apply the map to the transfer function","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"bHCwpeeVrj"}],"key":"es6i4wIyg1"}],"key":"h2kVPUWulI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:06.037679Z","iopub.status.busy":"2023-06-22T17:22:06.037302Z","iopub.status.idle":"2023-06-22T17:22:06.147564Z","shell.execute_reply":"2023-06-22T17:22:06.146876Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Renderers can have multiple transfer functions.\n# GetPrimaryTransferFunction returns the one that is usually the most useful.\n# You can use `tf.GetTransferFunction(var_name)` to get other transfer functions.\ntf = ren.GetPrimaryTransferFunction()\ntf.SetOpacityControlPoints(opacities)\nses.Show()","key":"TSls3u2l29"},{"type":"output","id":"R8I8GtXK-Eg9_02eLbA2a","data":[],"key":"tkaDJX8axx"}],"key":"dxthk9IZqi"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"You can adjust the colormap in a similar fashion. Use ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"uxCwoDJRpP"},{"type":"inlineCode","value":"help(tf)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"vbkpS6rT2X"},{"type":"text","value":" for more information.\nVapor includes a list of built-in colormaps and these can be applied with ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qo8P9DgXov"},{"type":"inlineCode","value":"tf.LoadBuiltinColormap(name)","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XUr0ELouix"}],"key":"uAafWTudVJ"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Builtin Colormaps","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"cnly8Be8Eo"}],"identifier":"builtin-colormaps","label":"Builtin Colormaps","html_id":"builtin-colormaps","implicit":true,"key":"Jdo3Dg1PSU"}],"key":"E5s0LPjiIw"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:06.150546Z","iopub.status.busy":"2023-06-22T17:22:06.150311Z","iopub.status.idle":"2023-06-22T17:22:06.227098Z","shell.execute_reply":"2023-06-22T17:22:06.226389Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"tf.LoadBuiltinColormap(\"Sequential/BlackBodyExtended\")\nses.Show()","key":"BegjWjnRbn"},{"type":"output","id":"xgLGctneTa96nh2vM4K9t","data":[],"key":"XC9CowEY6n"}],"key":"JpZkCbDDAt"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"List of All Builtin Colormaps","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"EGK5Oc5CUU"}],"identifier":"list-of-all-builtin-colormaps","label":"List of All Builtin Colormaps","html_id":"list-of-all-builtin-colormaps","implicit":true,"key":"Ty2WSGIVUV"}],"key":"aydWZTgRrq"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:22:06.230070Z","iopub.status.busy":"2023-06-22T17:22:06.229816Z","iopub.status.idle":"2023-06-22T17:22:10.518508Z","shell.execute_reply":"2023-06-22T17:22:10.517729Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"\nses.DeleteRenderer(ren)\nren = data.NewRenderer(renderer.TwoDDataRenderer)\ntf = ren.GetPrimaryTransferFunction()\n\nfor cmap in transferfunction.TransferFunction.ListBuiltinColormaps():\n    tf.LoadBuiltinColormap(cmap)\n\n    print(cmap)\n    tf.ShowMatPlotLibColorbar()","key":"g6rE9fihcH"},{"type":"output","id":"KQdBrR54RVS8ElrtGS2FF","data":[],"key":"Hla8bDHA2Y"}],"key":"DIoIXOH1D5"}],"key":"yjNlVM3wo4"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Controlling the Camera","url":"/notebooks/camera-example","group":"Foundations of VAPOR Python"},"next":{"title":"Annotations","url":"/notebooks/annotation-example","group":"Foundations of VAPOR Python"}}},"domain":"http://localhost:3000"}