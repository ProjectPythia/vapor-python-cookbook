{"version":2,"kind":"Notebook","sha256":"520bbf9b0b66c126c083cffd320bb052d43dd06cbd13c03cbb08d4f2a0c67c40","slug":"notebooks.workflow-example","location":"/notebooks/workflow_example.ipynb","dependencies":[],"frontmatter":{"title":"Generic Workflow","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"vapor","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/vapor-python-cookbook","copyright":"2024","affiliations":[{"id":"University at Albany (State University of New York)","name":"University at Albany (State University of New York)"},{"id":"UCAR/NCAR","name":"UCAR/NCAR"}],"numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/vapor-python-cookbook/blob/main/notebooks/workflow_example.ipynb","exports":[{"format":"ipynb","filename":"workflow_example.ipynb","url":"/vapor-python-cookbook/build/workflow_example-8169af9245ac43672b34e2c775d57909.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This shows an example workflow with vapor.\nWe begin by creating a session and opening a dataset.\nYou can have multiple sessions open at the same time.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nF9G3mk3rW"}],"key":"wYJ0EvXHfv"}],"key":"tSu8xGhT1f"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import example_utils\nfrom vapor import session, renderer, dataset, camera","key":"IicvX9GCjt"},{"type":"output","id":"EhI4LqCesN8fMKwrpsXaM","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[1]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mexample_utils\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m session, renderer, dataset, camera\n\n\u001b[36mFile \u001b[39m\u001b[32m~/work/vapor-python-cookbook/vapor-python-cookbook/notebooks/example_utils.py:20\u001b[39m\n\u001b[32m     16\u001b[39m     sys.path.append(\u001b[33m'\u001b[39m\u001b[33m..\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01minspect\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m signature\n\u001b[32m---> \u001b[39m\u001b[32m20\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnumpy\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnp\u001b[39;00m\n\u001b[32m     21\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mmath\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m sin\n\u001b[32m     23\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mSampleFunctionOnRegularGrid\u001b[39m(f, ext=\u001b[38;5;28;01mNone\u001b[39;00m, shape=\u001b[38;5;28;01mNone\u001b[39;00m):\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'numpy'","ename":"ModuleNotFoundError","evalue":"No module named 'numpy'"}],"key":"vWALPDfzhF"}],"key":"laYyvJ9H7Q"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ses = session.Session()\ndata = example_utils.OpenExampleDataset(ses)","key":"bYvcafPRDK"},{"type":"output","id":"RFzjbeDtP4xWQEbuShCfY","data":[],"key":"LCqkgRnfWO"}],"key":"ytGWfcBs0w"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Dump the dataset metadata","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"deUDPZfFyj"}],"identifier":"dump-the-dataset-metadata","label":"Dump the dataset metadata","html_id":"dump-the-dataset-metadata","implicit":true,"key":"VNBx0utwM3"}],"key":"z1gJict3ok"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"print(\"Time Coordinate Variable Name:\", data.GetTimeCoordVarName())\nprint(\"Coordinate Variable Names:\", data.GetCoordVarNames())\n\nprint(\"Dimensions:\")\nfor dim in data.GetDimensionNames():\n    print(f\"  {dim}:\", data.GetDimensionLength(dim, 0))\n\nprint(\"Data Variables:\")\nfor var in data.GetDataVarNames():\n    print(f\"  {var}\")\n    print(f\"    Time Varying:\", bool(data.IsTimeVarying(var)))\n    print(f\"    Dimensionality:\", data.GetVarGeometryDim(var))\n    print(f\"    Coordinates:\", data.GetVarCoordVars(var, True))\n    print(\"     Data Range:\", data.GetDataRange(var))","key":"GDMLvvH7CZ"},{"type":"output","id":"rbHNVsPIsJzb2D8TxXNbf","data":[],"key":"SNjyNKjJAB"}],"key":"ZTWiy2MvJ8"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Render the first 2D variable as a pseudocolor","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Gv9pG5Nx7u"}],"identifier":"render-the-first-2d-variable-as-a-pseudocolor","label":"Render the first 2D variable as a pseudocolor","html_id":"render-the-first-2d-variable-as-a-pseudocolor","implicit":true,"key":"R70hq1pJ93"}],"key":"uoJZK9uHEF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"first_2d_var = data.GetDataVarNames(2)[0]\nprint(f\"Rendering 2D variable {first_2d_var}\")\n\nren = data.NewRenderer(renderer.TwoDDataRenderer)\nren.SetVariableName(first_2d_var)\nren.GetPrimaryTransferFunction().SetMinMapValue(-1)\nren.GetPrimaryTransferFunction().SetMaxMapValue(1)\n\nses.GetCamera().ViewAll()\nses.Show()\n\nses.DeleteRenderer(ren)","key":"UZ5yXowBDW"},{"type":"output","id":"f97Gnnx5TEQWXRiORavAh","data":[],"key":"mVGTKQsZzn"}],"key":"MQGP9hruvn"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Render U10 and V10 as barbs over a map","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"SiZF4GmMyr"}],"identifier":"render-u10-and-v10-as-barbs-over-a-map","label":"Render U10 and V10 as barbs over a map","html_id":"render-u10-and-v10-as-barbs-over-a-map","implicit":true,"key":"aIWD1ySSlo"}],"key":"xkgmwp8nUZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# If your dataset is geo-referenced, this will automatically render a geographically correct map.\n# map_ren = data.NewRenderer(renderer.ImageRenderer)\n\nbarbs = data.NewRenderer(renderer.BarbRenderer)\nbarbs.SetDimensions(2)\nbarbs.SetFieldVariableNames(['U10', 'V10'])\nbarbs.SetLineThickness(2)\n\nses.Show()\nses.DeleteRenderer(barbs)","key":"XTAPwX6AuR"},{"type":"output","id":"aKCYH0FLH9PrpqA5-35kz","data":[],"key":"TgNEan7Rdk"}],"key":"NwicK0ql62"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Simulate and render a flow advection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"D6eEq3baM9"}],"identifier":"simulate-and-render-a-flow-advection","label":"Simulate and render a flow advection","html_id":"simulate-and-render-a-flow-advection","implicit":true,"key":"wlWdOtuUDW"}],"key":"BDLUU7A3uB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"flow = data.NewRenderer(renderer.FlowRenderer)\nflow.SetFieldVariableNames(['U10', 'V10'])\n\nses.Show()\n\nses.DeleteRenderer(flow)","key":"ZwmtW8HM3Y"},{"type":"output","id":"oL6JQO-ZUphSn7wjUVtkG","data":[],"key":"bzfmKY48vL"}],"key":"T3BQCfxmLL"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Volume render a 3D variable","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oMX1nsWHmV"}],"identifier":"volume-render-a-3d-variable","label":"Volume render a 3D variable","html_id":"volume-render-a-3d-variable","implicit":true,"key":"cRENp0B79G"}],"key":"fNKFRLe4Ac"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"volume = data.NewRenderer(renderer.VolumeRenderer)\nvolume.SetVariableName(\"V\")\n\ntf = volume.GetPrimaryTransferFunction()\ntf.SetOpacityList([1, 0, 0, 1])\n\nses.GetCamera().ViewAll()\nses.Show()\n\n# Show a colorbar for the volume rendering\ntf.ShowMatPlotLibColorbar(label=\"V\")","key":"WCSjv1itS3"},{"type":"output","id":"z3YdIMTCXJQuCphiLnpEr","data":[],"key":"CnZS3SKUxN"}],"key":"M86BMI5Jga"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Scale the dataset Z axis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"FJvCS3uhvg"}],"identifier":"scale-the-dataset-z-axis","label":"Scale the dataset Z axis","html_id":"scale-the-dataset-z-axis","implicit":true,"key":"vtp9IFcYDg"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Vapor will automatically scale the Z axis of a dataset to produce reasonable results.\nThis can be manually adjusted as shown below.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IiyoW4bYlv"}],"key":"qGEgibtO6k"}],"key":"zTT8uccRGe"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"scales = data.GetTransform().GetScales()\nprint(\"Default dataset scaling =\", scales);\nscales[2] *= 0.3\ndata.GetTransform().SetScales(scales)\nprint(\"New dataset scaling =\", data.GetTransform().GetScales());\nses.Show()","key":"KgUtVMcx26"},{"type":"output","id":"lalqJF-ZAuuROWljGqcaB","data":[],"key":"QhuNJF0vYO"}],"key":"FZG7r3KNGz"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Add axis annotations to the rendering","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"IskFb9xtSG"}],"identifier":"add-axis-annotations-to-the-rendering","label":"Add axis annotations to the rendering","html_id":"add-axis-annotations-to-the-rendering","implicit":true,"key":"xrgODezhes"}],"key":"jzdVIgbL3x"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"annotations = ses.GetAxisAnnotations()\nannotations.SetAxisAnnotationEnabled(True)\nses.Show()","key":"MMw9nTRqfj"},{"type":"output","id":"7xgy6OamwL6N1zEbgUQQS","data":[],"key":"GrVoKGd8c0"}],"key":"EL28qiLzqg"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Export the session for use in the Vapor GUI application","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"nO6iEkZMmQ"}],"identifier":"export-the-session-for-use-in-the-vapor-gui-application","label":"Export the session for use in the Vapor GUI application","html_id":"export-the-session-for-use-in-the-vapor-gui-application","implicit":true,"key":"kdwxmNiw7t"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"Sessions created in Python can be saved as a .vs3 file.\nThese files can then be opened in the Vapor GUI application and explored interactively.\nConversely, sessions created in the Vapor GUI can be loaded into Python with ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"hYNKzqwRA1"},{"type":"inlineCode","value":"Session.Load(path)","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"IBQxWwlRBx"}],"key":"BxXTzsTwvj"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Since this example uses a dynamically generated dataset, the session cannot be saved as\nit would point to a dataset that does not exist on disk. If you were using a physical dataset,\nthis would work.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"xvmEma4jlN"}],"key":"cWqYRIURVX"}],"key":"DDt0eGElRl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ses.Save(\"tutorial.vs3\")","key":"pKMpF7Uz9Z"},{"type":"output","id":"_5oaJm5jYUM4qjpHutx1v","data":[],"key":"KoAJAjZZHF"}],"key":"xbppui4HT4"}],"key":"KaU8OG3hk8"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"AGU 2023 Tutorial: Visualizing 2D and 3D Geoscience Data in Python","url":"/notebooks/agu-2023-example","group":"Example workflows"},"next":{"title":"Visualizing the cloud-capped boundary layer","url":"/notebooks/cloudfield-visualizer","group":"Example workflows"}}},"domain":"http://localhost:3000"}