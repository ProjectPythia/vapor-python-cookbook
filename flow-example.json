{"version":2,"kind":"Notebook","sha256":"f831c8457ad77979acacdef45faa7ce702c38be0fafa53ea745c6556ab934fd3","slug":"flow-example","location":"/notebooks/flow_example.ipynb","dependencies":[],"frontmatter":{"title":"Advecting Flow Paths","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"vapor","language":"python"},"jupytext":{},"authors":[{"nameParsed":{"literal":"Project Pythia Community","given":"Project Pythia","family":"Community"},"name":"Project Pythia Community","url":"https://projectpythia.org/","id":"contributors-myst-generated-uid-0"}],"open_access":true,"license":{"content":{"id":"Apache-2.0","url":"https://opensource.org/licenses/Apache-2.0","name":"Apache License 2.0","free":true,"osi":true},"code":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/projectpythia/vapor-python-cookbook","copyright":"2024","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/projectpythia/vapor-python-cookbook/blob/main/notebooks/flow_example.ipynb","exports":[{"format":"ipynb","filename":"flow_example.ipynb","url":"/vapor-python-cookbook/build/flow_example-0ab7e99c14b803ae0de4576b735da1ca.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"Vapor can advect and render flow paths through your data.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"yrPyjEvRek"}],"key":"vuFbP9yQOI"}],"key":"t3D9sGWxQI"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:39.854271Z","iopub.status.busy":"2023-06-22T17:21:39.853971Z","iopub.status.idle":"2023-06-22T17:21:46.140430Z","shell.execute_reply":"2023-06-22T17:21:46.139618Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"import example_utils\nfrom vapor import session, renderer, dataset, camera\n\nses = session.Session()\ndata = example_utils.OpenExampleDataset(ses)","key":"OPROEtcaHe"},{"type":"output","id":"FTOubxohELXYHnrn-MvBb","data":[{"output_type":"error","traceback":"\u001b[31m---------------------------------------------------------------------------\u001b[39m\n\u001b[31mModuleNotFoundError\u001b[39m                       Traceback (most recent call last)\n\u001b[36mCell\u001b[39m\u001b[36m \u001b[39m\u001b[32mIn[1]\u001b[39m\u001b[32m, line 1\u001b[39m\n\u001b[32m----> \u001b[39m\u001b[32m1\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mexample_utils\u001b[39;00m\n\u001b[32m      2\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mvapor\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m session, renderer, dataset, camera\n\u001b[32m      4\u001b[39m ses = session.Session()\n\n\u001b[36mFile \u001b[39m\u001b[32m~/work/vapor-python-cookbook/vapor-python-cookbook/notebooks/example_utils.py:20\u001b[39m\n\u001b[32m     16\u001b[39m     sys.path.append(\u001b[33m'\u001b[39m\u001b[33m..\u001b[39m\u001b[33m'\u001b[39m)\n\u001b[32m     19\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01minspect\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m signature\n\u001b[32m---> \u001b[39m\u001b[32m20\u001b[39m \u001b[38;5;28;01mimport\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnumpy\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mas\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mnp\u001b[39;00m\n\u001b[32m     21\u001b[39m \u001b[38;5;28;01mfrom\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34;01mmath\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[38;5;28;01mimport\u001b[39;00m sin\n\u001b[32m     23\u001b[39m \u001b[38;5;28;01mdef\u001b[39;00m\u001b[38;5;250m \u001b[39m\u001b[34mSampleFunctionOnRegularGrid\u001b[39m(f, ext=\u001b[38;5;28;01mNone\u001b[39;00m, shape=\u001b[38;5;28;01mNone\u001b[39;00m):\n\n\u001b[31mModuleNotFoundError\u001b[39m: No module named 'numpy'","ename":"ModuleNotFoundError","evalue":"No module named 'numpy'"}],"key":"P1Jx3JiYzF"}],"key":"Mfphq2kM88"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Default advection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"jLufHztG4o"}],"identifier":"default-advection","label":"Default advection","html_id":"default-advection","implicit":true,"key":"ZKuSfCkUNV"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"When you create a Flow renderer, the default advection will create a regularly dispersed grid of seed points and simulate a streamline advection in 2D or 3D, depending on the provided variables.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"G6sWE1ye0x"}],"key":"sFvDEdwQJC"}],"key":"tIX3qdyTyp"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.144664Z","iopub.status.busy":"2023-06-22T17:21:46.144287Z","iopub.status.idle":"2023-06-22T17:21:46.476511Z","shell.execute_reply":"2023-06-22T17:21:46.475881Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Use first 2 2D variables as our U,V for the flow advection\ndimension = 2\nU,V = data.GetDataVarNames(dimension)[0:2]\n\nren:renderer.FlowRenderer = data.NewRenderer(renderer.FlowRenderer)\nren.SetFieldVariableNames([U, V])\nses.GetCamera().ViewAll()\nses.Show()","key":"tVxucF33Uc"},{"type":"output","id":"rFwkPHu1LyEHh8V47L8I3","data":[],"key":"QwXE4qaCcb"}],"key":"UZHr5yR76Q"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Rendering techniques","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GQzRDdLfBy"}],"identifier":"rendering-techniques","label":"Rendering techniques","html_id":"rendering-techniques","implicit":true,"key":"Yq2PHFqllK"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The rendering of the flow paths can be configured. A few examples are shown below.\nCall help(renderer.FlowRenderer) to see additional options.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qJOW4FyzeQ"}],"key":"qKg9h7XQPc"}],"key":"hcwNdWkjaO"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.479431Z","iopub.status.busy":"2023-06-22T17:21:46.479193Z","iopub.status.idle":"2023-06-22T17:21:46.630855Z","shell.execute_reply":"2023-06-22T17:21:46.630223Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetRenderType(ren.RenderType.RenderTypeStream)\nren.SetRenderRadiusScalar(3)\nren.SetRenderGeom3D(True)\nren.SetColorMapVariableName(U)\nses.Show()","key":"HSFrV01Tva"},{"type":"output","id":"_KNa2dFgH6MCI2hQsDSxE","data":[],"key":"DUdePCLqWF"}],"key":"SNRTK6V4s2"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Rather than rendering the flow lines, you can also render the sample points that are taken along the flow path individually.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"eQGg3A1j6y"}],"key":"HDiSuIHrBP"}],"key":"Ai1PijUTvQ"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.633492Z","iopub.status.busy":"2023-06-22T17:21:46.633267Z","iopub.status.idle":"2023-06-22T17:21:46.691538Z","shell.execute_reply":"2023-06-22T17:21:46.690949Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetRenderType(ren.RenderType.RenderTypeSamples)\nses.Show()","key":"rXQaPXEMKN"},{"type":"output","id":"RrRpkCUZjGZ6zKUChak3b","data":[],"key":"PoHTnGpWLM"}],"key":"YwsZfxehAj"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.694219Z","iopub.status.busy":"2023-06-22T17:21:46.694028Z","iopub.status.idle":"2023-06-22T17:21:46.820968Z","shell.execute_reply":"2023-06-22T17:21:46.820377Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetRenderGlyphType(ren.GlpyhType.GlpyhTypeArrow)\nren.SetRenderRadiusScalar(7)\nses.Show()","key":"GkmzUSgbAK"},{"type":"output","id":"xIHzuFhupSHM0spIGaRJc","data":[],"key":"FO9J5dIhuH"}],"key":"jvAgugEH0Q"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.823965Z","iopub.status.busy":"2023-06-22T17:21:46.823519Z","iopub.status.idle":"2023-06-22T17:21:46.826861Z","shell.execute_reply":"2023-06-22T17:21:46.826229Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"# Reset the rendering style for the next section\nren.SetRenderRadiusScalar(3)\nren.SetRenderType(ren.RenderType.RenderTypeStream)","key":"u0UqmLpGyN"},{"type":"output","id":"2zMBdy1ivs2eQ9mzzKjxb","data":[],"key":"AVcoD7SN4o"}],"key":"zOnElF2a7r"},{"type":"block","kind":"notebook-content","data":{"region_name":"md"},"children":[{"type":"heading","depth":2,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Seeding the advection","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"WFckhoHogC"}],"identifier":"seeding-the-advection","label":"Seeding the advection","html_id":"seeding-the-advection","implicit":true,"key":"ORugFNGrOg"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The seeds from which the advected particles start can be configured in a variety of manners.\nCall help(renderer.FlowRenderer) to see additional options.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"b8NOdsWmC8"}],"key":"xeWLaGAoiA"}],"key":"ejgZJALp4M"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Uniform Distribution","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"pmMwmYAu1y"}],"identifier":"uniform-distribution","label":"Uniform Distribution","html_id":"uniform-distribution","implicit":true,"key":"kHdmZJHkDi"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"This is the default. It creates a uniformly distributed grid of seed points over the area/volume of the advected region.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"znhfZjwgNp"}],"key":"WT2wrbL5ij"}],"key":"PwkGqZloFb"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:46.829533Z","iopub.status.busy":"2023-06-22T17:21:46.829301Z","iopub.status.idle":"2023-06-22T17:21:47.056742Z","shell.execute_reply":"2023-06-22T17:21:47.056106Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetSeedGenMode(ren.FlowSeedMode.UNIFORM)\nrake = ren.GetRakeRegion()\ndefaultRakeExtents = rake.GetExtents()\nrake.SetExtents((20, 20), (40, 40))\nprint(f\"Seeding a {ren.GetGridNumOfSeeds()} grid over {rake.GetExtents()}\")\nses.Show()\nrake.SetExtents(*defaultRakeExtents)","key":"pH3af2PV8W"},{"type":"output","id":"tN6e0BE9igjYmRzXpkJ4B","data":[],"key":"DxgAskhReY"}],"key":"Ye9CZQvvTT"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Random Distribution","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qWb2qlj9XU"}],"identifier":"random-distribution","label":"Random Distribution","html_id":"random-distribution","implicit":true,"key":"B0VsvNTOe3"}],"key":"hUvQIIhY6x"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:47.059731Z","iopub.status.busy":"2023-06-22T17:21:47.059483Z","iopub.status.idle":"2023-06-22T17:21:47.119473Z","shell.execute_reply":"2023-06-22T17:21:47.118849Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetSeedGenMode(ren.FlowSeedMode.RANDOM)\nprint(f\"Seeding {ren.GetRandomNumOfSeeds()} random points over {rake.GetExtents()}\")\nses.Show()","key":"KPYRNKdDBQ"},{"type":"output","id":"nXwsTW_0XPaOiK_MgmGA2","data":[],"key":"hAezhrvXRX"}],"key":"s4ZvwIUQOi"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Biased Distribution","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"avI9DHmtmU"}],"identifier":"biased-distribution","label":"Biased Distribution","html_id":"biased-distribution","implicit":true,"key":"PPykQ6LMtL"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"This generates a random list of seed points however they are biased by a given variable.\nThe number of seed points can be higher or lower based on the value of the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"RS4wNmxAWP"},{"type":"inlineCode","value":"RakeBiasVariable","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"Mjt0oyEwW8"},{"type":"text","value":".\nYou can set the ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"dRdRMWyuIG"},{"type":"inlineCode","value":"RakeBiasStrength","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"qykYclz4X2"},{"type":"text","value":" to a negative value to invert the bias.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"mkhcxgsGOV"}],"key":"koTdpMBGny"}],"key":"pMmU7skpEx"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:47.122371Z","iopub.status.busy":"2023-06-22T17:21:47.122118Z","iopub.status.idle":"2023-06-22T17:21:47.191623Z","shell.execute_reply":"2023-06-22T17:21:47.191104Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"ren.SetSeedGenMode(ren.FlowSeedMode.RANDOM_BIAS)\nren.SetRakeBiasVariable(V)\nren.SetRakeBiasStrength(1)\nprint(f\"Seeding {ren.GetRandomNumOfSeeds()} random points biased by {ren.GetRakeBiasVariable()} over {rake.GetExtents()}\")\nses.Show()","key":"WppiybSUbS"},{"type":"output","id":"NmyoJQM2Wv31lGm02HhHB","data":[],"key":"ZoEygQZPQV"}],"key":"uQQRAXUCoV"},{"type":"block","kind":"notebook-content","data":{"lines_to_next_cell":0,"region_name":"md"},"children":[{"type":"heading","depth":3,"position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Manual List","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"AgcGoBzrfa"}],"identifier":"manual-list","label":"Manual List","html_id":"manual-list","implicit":true,"key":"F3svriUssX"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"You can pass in a manually created list of seeds using a basic text file format.\nThe code below generates an example seed file and passes it to Vapor.\nThe full documentation for the seed file format can be found on Vapor’s website.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"AhGSnE6sYo"}],"key":"LpH9ozkYTm"}],"key":"AAe696sKSP"},{"type":"block","kind":"notebook-code","data":{"execution":{"iopub.execute_input":"2023-06-22T17:21:47.194692Z","iopub.status.busy":"2023-06-22T17:21:47.194336Z","iopub.status.idle":"2023-06-22T17:21:47.240073Z","shell.execute_reply":"2023-06-22T17:21:47.239479Z"}},"children":[{"type":"code","lang":"python","executable":true,"value":"with open(\"flow_seeds.txt\", \"w\") as f:\n    print(\"# X, Y, Z, T (optional)\", file=f)\n    print(\"10, 10, 0\", file=f)\n    print(\"20, 20, 0\", file=f)\n\nren.SetSeedGenMode(ren.FlowSeedMode.LIST)\nren.SetSeedInputFilename(\"flow_seeds.txt\")\nses.Show()","key":"J0yuKND0sZ"},{"type":"output","id":"-DhT2lQ67SLnoM4nFAImJ","data":[],"key":"wDjKRf2a2U"}],"key":"I3JDi1OcJl"}],"key":"eRecESNco3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Keyframing with Vapor","url":"/keyframing-example","group":"Foundations of VAPOR Python"},"next":{"title":"Visualizer Widgets","url":"/visualizer-widget-example","group":"Foundations of VAPOR Python"}}},"domain":"http://localhost:3000"}